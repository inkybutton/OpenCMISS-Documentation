\section{Laplace Equations}
\label{sec:LaplaceEquations}

\subsection{Governing equations}

The \emph{generalised Laplace's equation} on a domain $\Omega$ with boundary $\Gamma$
in \OpenCMISS can be stated as
\begin{equation}
  \addtolength{\fboxsep}{5pt}
  \boxed{
    \divergence{}{\pbrac{\fnof{\conductivitytensor}{\coordinatevector}\gradient{}{\fnof{u}{\coordinatevector,t}}}}=0
  }
  \label{eqn:GeneralisedLaplaceEquation}
\end{equation}
where $\coordinatevector\in\Omega$, $t\in[0,\infty)$, $\fnof{u}{\coordinatevector,t}$ is the potential and 
$\fnof{\conductivitytensor}{\coordinatevector}$ is the (positive definite) conductivity
tensor throughout the domain. Note that $\conductivitytensor=\tensor{I}$ gives 
the \emph{standard form of Laplace's equation} \ie
\begin{equation}
  \addtolength{\fboxsep}{5pt}
  \boxed{
    \laplacian{}{\fnof{u}{\coordinatevector,t}}=0
  }
  \label{eqn:LaplaceEquation}
\end{equation}

\OpenCMISS solves one further Laplace type equation, that of a \emph{moving mesh Laplace's equation}, that is used during ALE type mechanics problems. For a mesh displacement field, $\fnof{\vectr{w}}{\coordinatevector,t}$, the moving mesh Laplace's equation is
\begin{equation}
  \addtolength{\fboxsep}{5pt}
  \boxed{
    \divergence{}{\pbrac{\fnof{k^{i}}{\coordinatevector}\gradient{}{\fnof{w^{i}}{\coordinatevector,t}}}}=0
  }
  \label{eqn:MovingMeshLaplaceEquation}
\end{equation}
where $i$ ranges from $1$ to the number of dimensions of $n$.

To complete the description of the boundary value problem,
the governing \eqnref{eqn:GeneralisedLaplaceEquation} is supplemented
by suitable boundary conditions on the domain boundary~$\Gamma$.
These boundary conditions can either be of Dirichlet type and specify a
solution value, $\fnof{D}{\coordinatevector,t}$, \ie
\begin{equation}
  \fnof{u}{\coordinatevector,t} = \fnof{D}{\coordinatevector,t} \quad \coordinatevector\in\Gamma_{D},t\in[0,\infty)
  \label{eqn:LaplaceDirichletBC} 
\end{equation}
and/or of Neumann type and specify the solution gradient in normal direction,
$\fnof{N}{\coordinatevector,t}$, \ie
\begin{equation}
  \fnof{q}{\coordinatevector,t} = \dotprod{\pbrac{\fnof{\sharptensor{\conductivitytensor}}{\coordinatevector}
      \gradient{}{\fnof{u}{\coordinatevector,t}}}}{\fnof{\normal}{\coordinatevector}} =
  \fnof{N}{\coordinatevector,t} \quad \coordinatevector\in\Gamma_{N},t\in[0,\infty)
  \label{eqn:LaplaceNeumannBC} 
\end{equation}
where $\fnof{q}{\coordinatevector,t}$ is the flux in the normal direction, $\fnof{\normal}{\coordinatevector}$ is the normal
vector to the boundary and $\Gamma = \Gamma_D \cup \Gamma_N$.

\subsection{Weak formulation}

The corresponding weak form of \eqnref{eqn:GeneralisedLaplaceEquation} is
\begin{equation}
  \gint{\Omega}{}{\divergence{}{\pbrac{\conductivitytensor\gradient{}{u}}}w}{\Omega}=0 
  \label{eqn:LaplaceWeakForm}
\end{equation}
where $w$ is a suitable test function (For a definition of what constitutes a
``suitable'' test and trial function, see \secref{} - still has to be written).

Applying Green's theorem to \eqnref{eqn:LaplaceWeakForm} gives
\begin{equation}
 \gint{\Omega}{}{\divergence{}{\pbrac{\conductivitytensor\gradient{}{u}}}w}{\Omega}
 = -\gint{\Omega}{}{\dotprod{\pbrac{\conductivitytensor\gradient{}{u}}}{\gradient{}{w}}}{\Omega}
   +\gint{\Gamma}{}{\dotprod{\pbrac{\conductivitytensor\gradient{}{u}}}{\normal}w}{\Gamma}
 = 0
\end{equation}
or
\begin{equation}
  \gint{\Omega}{}{\dotprod{\pbrac{\conductivitytensor\gradient{}{u}}}{\gradient{}{w}}}{\Omega}
  = \gint{\Gamma}{}{\dotprod{\pbrac{\conductivitytensor\gradient{}{u}}}{\normal}w}{\Gamma} \,,
  \label{eqn:LaplaceWeightedResidualForm}
\end{equation}

\subsection{Tensor notation}

If we now consider the integrand of the left hand side of
\eqnref{eqn:LaplaceWeightedResidualForm} in tensorial form with covariant
derivatives indicated by a semi-colon in the index
(see \secref{subsec:function derivatives} for details) then
\begin{equation}
  \conductivitytensor\gradient{}{u} = \conductivitytensorsymbol^{i}_{.j}\covarderiv{u}{i}
  \label{eqn:LaplaceWeakFormFactor1}
\end{equation}
and
\begin{equation}
  \gradient{}{w} = \covarderiv{w}{k}
  \label{eqn:LaplaceWeakFormFactor2}
\end{equation}

Now, \eqnref{eqn:LaplaceWeakFormFactor1}) and
\eqnref{eqn:LaplaceWeakFormFactor2} both represent covariant vectors
and therefore we must convert \eqnref{eqn:LaplaceWeakFormFactor2} to a
contravariant vector by multiplying by the contravariant metric tensor
(from $\vectr{i}$ to $\coordinatevector$ coordinates; see
\secrefs{sec:MetricTensors}{sec:CoordinateSystems}) so that we can
take the dot product. The final tensorial form for the left hand
integral is
\begin{equation}
  \dotprod{\pbrac{\conductivitytensor\gradient{}{u}}}{\gradient{}{w}} = 
  \generalmetrictensorsymbol^{kj}\conductivitytensorsymbol^{i}_{.j}\covarderiv{u}{i}\covarderiv{w}{k}
\end{equation}
and thus \eqnref{eqn:LaplaceWeightedResidualForm} becomes
\begin{equation}
  \gint{\Omega}{}{\generalmetrictensorsymbol^{kj}\conductivitytensorsymbol^{i}_{.j}\covarderiv{u}{i}\covarderiv{w}{k}}{\Omega}
  = \gint{\Gamma}{}{\generalmetrictensorsymbol^{kj}\conductivitytensorsymbol^{i}_{.j}\covarderiv{u}{i}\normalsymbol_{k}w}{\Gamma}
  \label{eqn:LaplaceWeightedResidualTensorForm1}
\end{equation}
or
\begin{equation}
  \gint{\Omega}{}{\generalmetrictensorsymbol^{kj}\conductivitytensorsymbol^{i}_{.j}\covarderiv{u}{i}\covarderiv{w}{k}}{\Omega}
  = \gint{\Gamma}{}{qw}{\Gamma}
  \label{eqn:LaplaceWeightedResidualTensorForm2}
\end{equation}

\subsection{Finite element formulation}

We can now discretise the domain into finite elements \ie $\Omega=
\displaystyle{\bigcup_{e=1}^{E}}\Omega_{e}$ with
$\Gamma=\displaystyle{\bigcup_{f=1}^{F}}\Gamma_{f}$, 
\eqnref{eqn:LaplaceWeightedResidualTensorForm2} becomes
\begin{equation}
  \dsum_{e=1}^{E}\gint{\Omega_{e}}{}{\conductivitytensorsymbol^{i}_{j}\covarderiv{u}{i}\generalmetrictensorsymbol^{kj}
    \covarderiv{w}{k}}{\Omega}
  =\dsum_{f=1}^{F}\gint{\Gamma_{f}}{}{qw}{\Gamma}
\end{equation}

The next step is to approximate the dependent variable, $u$, using basis
functions. To simplify this for different types of basis functions an
\emph{interpolation notation} is adopted. This interpolation is such that
$\gbfn{n}{\beta}{\elementcoordinatevector}$ are the appropriate basis functions for the
type of element (\eg \bicubicherm, Hermite-sector, \etc) and dimension of 
the problem (one, two or \threedal). For example if $\elementcoordinatevector=\bbrac{\xi}$ 
and the element is a cubic Hermite element
(\secref{sec:Hermitianbasisfunctions}) then $\gbfn{n}{\beta}{\elementcoordinatevector}$ 
are the cubic Hermite basis functions where the local node number $n$ ranges 
from $1$ to $2$ and the derivative $\beta$ ranges from $0$ to $1$. If,
however, $\elementcoordinatevector=\bbrac{\elemcoordone,\elemcoordtwo}$ and the element is a \bicubicherm 
element then $n$ ranges from $1$ to $4$, $\beta$ ranges from $0$ to $3$ and
$\gbfn{n}{\beta}{\elementcoordinatevector}$ is the appropriate basis function for the nodal
variable $\nodedof{u}{n}{\beta}$. The nodal variables are defined as
follows: $\nodedof{u}{n}{0}=\nodept{u}{n}$,
$\nodedof{u}{n}{1}=\delby{\nodept{u}{n}}{s_{1}}$,
$\nodedof{u}{n}{2}=\delby{\nodept{u}{n}}{s_{2}}$,
$\nodedof{u}{n}{3}=\deltwoby{\nodept{u}{n}}{s_{1}}{s_{2}}$,
\etc Hence for the \bicubicherm element the interpolation function
$\gbfn{2}{3}{\elementcoordinatevector}$ multiplies the nodal variable
$\nodedof{u}{2}{3}=\deltwoby{u^{2}}{s_{1}}{s_{2}}$ and thus the
interpolation function is $\chbfn{2}{1}{\elemcoordone}\chbfn{1}{1}{\elemcoordtwo}$.  The
scale factors for the Hermite interpolation are handled by the introduction of
an interpolation scale factor $\gsf{n}{\beta}$ defined as follows:
$\gsf{n}{0}=1$, $\gsf{n}{1}=\nsftwo{n}{1}$, $\gsf{n}{2}=
\nsftwo{n}{2}$, $\gsf{n}{3}=\nsftwo{n}{1}\nsftwo{n}{2}$,
\etc For Lagrangian basis functions the interpolation scale factors are all
one.

Note that the elemental coordinates are denoted with
$\elementcoordinatevector$ whereas the coordinates of the boundary of
that element are denoted with $\boundarycoordinatevector$. The number
of components in $\boundarycoordinatevector$ is one less than the
number of components in $\elementcoordinatevector$.

The general form of the interpolation notation for $u$ is then
\begin{equation}
  \fnof{u}{\elementcoordinatevector}=\gbfn{n}{\beta}{\elementcoordinatevector}\nodedof{u}{n}{\beta}\gsf{n}{\beta}
  \label{eqn:uInterpolationLaplace}
\end{equation}

We can also interpolate the other variables in a similar manner \ie
\begin{equation}
  \begin{split}
    \fnof{q}{\boundarycoordinatevector} &= \gbfn{o}{\gamma}{\boundarycoordinatevector}\nodedof{q}{o}{\gamma}\gsf{o}{\gamma} \\
    \fnof{\conductivitytensor}{\elementcoordinatevector}
    &=\gbfn{l}{\delta}{\elementcoordinatevector}\nodedof{\conductivitytensor}{l}{\delta}\gsf{l}{\delta} \\
  \end{split}
\end{equation}
where $\nodedof{q}{o}{\gamma}$ and $\nodedof{\conductivitytensor}{l}{\delta}$ are the
nodal degrees-of-freedom for the flux variable and conductivity tensor.

Using a Galerkin finite element approach (where the weighting functions are
chosento be the interpolating basis functions) we have 
\begin{equation}
  \fnof{w}{\elementcoordinatevector}=\gbfn{m}{\alpha}{\elementcoordinatevector}\gsf{m}{\alpha}
\end{equation}

\subsection{Spatial integration}

When dealing with integrals a similar interpolation notation is
adopted in that $\exteriorderiv{\elementcoordinatevector}$ is the
appropriate infinitesimal for the dimension of the problem. The limits
of the integral are also written in bold font and indicate the
appropriate number of integrals for the dimension of the problem.  For
example if
$\elementcoordinatevector=\bbrac{\elemcoordone,\elemcoordtwo}$ then
$\gint{\vectr{0}}{\vectr{1}}{x}
{\elementcoordinatevector}=\giint{0}{1}{0}{1}{x}{\elemcoordone}{\elemcoordtwo}$,
but if
$\elementcoordinatevector=\bbrac{\elemcoordone,\elemcoordtwo,\elemcoordthree}$
then $\gint{\vectr{0}}{\vectr{1}}{x}{\elementcoordinatevector}=
\dintl{0}{1}\!\dintl{0}{1}\!\dintl{0}{1}\,\threeform{x}{\elemcoordone}{\elemcoordtwo}{\elemcoordthree}$.

In order to integrate in $\elementcoordinatevector$ coordinates we must convert the spatial
derivatives to derivatives with respect to $\elementcoordinatevector$. Using the tensor
transformation equations for a covariant vector we have
\begin{equation}  
  \covarderiv{u}{i}=\delby{\elementcoordinate{s}}{\coordinate{i}}\covarderiv{u}{s}=
  \delby{\elementcoordinate{s}}{\coordinate{i}}\delby{u}{\elementcoordinate{s}}
\end{equation}
and 
\begin{equation}
  \covarderiv{w}{k}=\delby{\elementcoordinate{r}}{\coordinate{k}}\covarderiv{w}{r}=
  \delby{\elementcoordinate{r}}{\coordinate{k}}\delby{w}{\elementcoordinate{r}}
\end{equation}

As we only know $\tilde{\conductivitytensor}$, the conductivity in the
$\fibrecoordinatevector$ (fibre) coordinate system rather than
$\conductivitytensor$, the conductivity in the $\coordinatevector$
(geometric) coordinate system, we must transform the mixed tensor
${\tilde{\conductivitytensorsymbol}}^{a}_{.b}$ from
$\fibrecoordinatevector$ to $\coordinatevector$ coordinates. However,
as the fibre coordinate system is defined in terms of
$\elementcoordinatevector$ coordinates we first transform the
conductivity tensor from $\fibrecoordinatevector$ to
$\elementcoordinatevector$ coordinates \ie
\begin{equation}
  \fnof{\conductivitytensorsymbol^{c}_{.d}}{\elementcoordinatevector}=
  \delby{\elementcoordinate{c}}{\fibrecoordinate{a}}\delby{\fibrecoordinate{b}}{\elementcoordinate{d}}
  \fnof{{\tilde{\conductivitytensorsymbol}}^{a}_{.b}}{\elementcoordinatevector}
\end{equation}
with $.b$ indicating that $b$ is the ``second'' index (\secref{subsec:SummationNotation}),
and then transform the conductivity from $\elementcoordinatevector$ coordinates to
$\coordinatevector$ coordinates \ie
\begin{equation}
  \begin{split}
    \fnof{\conductivitytensorsymbol^{i}_{.j}}{\elementcoordinatevector} &=
    \delby{\coordinate{i}}{\elementcoordinate{c}}\delby{\elementcoordinate{d}}{\coordinate{j}}
    \fnof{{\conductivitytensorsymbol}^{c}_{.d}}{\elementcoordinatevector} \\
    &= \delby{\coordinate{i}}{\elementcoordinate{c}}\delby{\elementcoordinate{d}}{\coordinate{j}}\delby{\elementcoordinate{c}} 
         {\fibrecoordinate{a}}\delby{\fibrecoordinate{b}}{\elementcoordinate{d}}
         \fnof{{\tilde{\conductivitytensorsymbol}}^{a}_{.b}}{\elementcoordinatevector}
  \end{split}
\end{equation}
where $\tilde{\conductivitytensor}$ is interpolated in the normal way \ie
\begin{equation}
  \fnof{\tilde{\conductivitytensor}}{\elementcoordinatevector}
  =\gbfn{l}{\delta}{\elementcoordinatevector}\nodedof{\tilde{\conductivitytensor}}{l}{\delta}
  \gsf{l}{\delta}
\end{equation}

Using an interpolated variables yields
\begin{multline}
  \dsum_{e=1}^{E}\dintl{\vectr{0}}{\vectr{1}}\generalmetrictensorsymbol^{kj}\delby{\coordinate{i}}{\elementcoordinate{c}}
    \delby{\elementcoordinate{d}}{\coordinate{j}}\delby{\elementcoordinate{c}}{\fibrecoordinate{a}}
    \delby{\fibrecoordinate{b}}{\elementcoordinate{d}}
    \fnof{{\tilde{\conductivitytensorsymbol}}^{a}_{.b}}{\elementcoordinatevector}\delby{\elementcoordinate{s}}{\coordinate{i}} \\
    \delby{\pbrac{\gbfn{n}{\beta}{\elementcoordinatevector}\nodedof{u}{n}{\beta}\gsf{n}{\beta}}}{\elementcoordinate{s}}
    \delby{\elementcoordinate{r}}{\coordinate{k}}\delby{\pbrac{\gbfn{m}{\alpha}{\elementcoordinatevector}
        \gsf{m}{\alpha}}}{\elementcoordinate{r}}
    \abs{\jacobian{\Omega_{e}}{\elementcoordinatevector}}\exteriorderiv{\elementcoordinatevector} \\ 
  = \dsum_{f=1}^{F}\gint{\vectr{0}}{\vectr{1}}{\gbfn{o}{\gamma}{\boundarycoordinatevector}\nodedof{q}{o}{\gamma}
    \gsf{o}{\gamma}\gbfn{m}{\alpha}{\boundarycoordinatevector}\gsf{m}{\alpha}
    \abs{\jacobian{\Gamma_{f}}{\boundarycoordinatevector}}}{\boundarycoordinatevector}
\end{multline}
where $\jacobian{\Omega_{e}}{\elementcoordinatevector}$ is the
\emph{Jacobian} of the transformation from the integration
$\fnof{\Omega_{e}}{\coordinatevector}$ to $\elementcoordinatevector$
coordinates and $\jacobian{\Gamma_{f}}{\boundarycoordinatevector}$ is
the \emph{Jacobian} of the transformation from the integration
$\fnof{\Gamma_{f}}{\coordinatevector}$ to $\boundarycoordinatevector$
coordinates.

Taking the fixed nodal degrees-of-freedom and scale factors outside the integral we have
\begin{multline}
  \dsum_{e=1}^{E}\nodedof{u}{n}{\beta}\gsf{m}{\alpha}\gsf{n}{\beta}
  \dintl{\vectr{0}}{\vectr{1}}\generalmetrictensorsymbol^{kj}\delby{\coordinate{i}}{\elementcoordinate{c}}
  \delby{\elementcoordinate{d}}{\coordinate{j}}\delby{\elementcoordinate{c}}{\fibrecoordinate{a}}
  \delby{\fibrecoordinate{b}}{\elementcoordinate{d}}\fnof{{\tilde{\conductivitytensorsymbol}}^{a}_{.b}}{\elementcoordinatevector} \\
  \delby{\elementcoordinate{r}}{\coordinate{i}}\delby{\elementcoordinate{s}}{\coordinate{k}}
  \delby{\gbfn{m}{\alpha}{\elementcoordinatevector}}{\elementcoordinate{s}}
  \delby{\gbfn{n}{\beta}{\elementcoordinatevector}}{\elementcoordinate{r}}
  \abs{\jacobian{\Omega_{e}}{\elementcoordinatevector}}\exteriorderiv{\elementcoordinatevector} \\
  = \dsum_{f=1}^{F}\nodedof{q}{o}{\gamma}\gsf{m}{\alpha}\gsf{o}{\gamma}
  \gint{\vectr{0}}{\vectr{1}}{\gbfn{m}{\alpha}{\boundarycoordinatevector}\gbfn{o}{\gamma}{\boundarycoordinatevector}
    \abs{\jacobian{\Gamma_{f}}{\boundarycoordinatevector}}}{\boundarycoordinatevector}
  \label{eqn:elementalfem1}
\end{multline}

\subsection{Matrix vector form}

\Eqnref{eqn:elementalfem1} is an equation of the form of
\begin{equation}
  \matr{K}\vect{u}-\vect{f}=\vect{0}
\end{equation}
or
\begin{equation}
  \matr{K}\vect{u}-\matr{N}\vectr{q}=\vect{0}
\end{equation}

The elemental stiffness matrix, $K^{\alpha\beta}_{mn}$, is given by
\begin{equation}
  K^{\alpha\beta}_{mn}=\gsf{m}{\alpha}\gsf{m}{\beta}
  \gint{\vectr{0}}{\vectr{1}}{\delby{\gbfn{m}{\alpha}{\elementcoordinatevector}}{\elementcoordinate{r}}
    \delby{\gbfn{n}{\beta}{\elementcoordinatevector}}{\elementcoordinate{s}}\fnof{\gamma^{rs}}{\elementcoordinatevector}
    \abs{\jacobian{\Omega}{\elementcoordinatevector}}}{\elementcoordinatevector}
  \label{eqn:elementalfemlhs2}
\end{equation}
where
\begin{equation}
  \fnof{\gamma^{rs}}{\elementcoordinatevector}=\generalmetrictensorsymbol^{kj}\delby{\coordinate{i}}{\elementcoordinate{c}}
  \delby{\elementcoordinate{d}}{\coordinate{j}}\delby{\elementcoordinate{c}}{\fibrecoordinate{a}}
  \delby{\fibrecoordinate{b}}{\elementcoordinate{d}}
  \fnof{{\tilde{\conductivitytensorsymbol}}^{a}_{.b}}{\elementcoordinatevector}
  \delby{\elementcoordinate{r}}{\coordinate{i}}\delby{\elementcoordinate{s}}{\coordinate{k}}
  \label{eqn:DiffusionOperatorGammaDefinition1}
\end{equation}
or
\begin{equation}
  \fnof{\gamma^{rs}}{\elementcoordinatevector}=\generalmetrictensorsymbol^{kj}
  \fnof{\conductivitytensorsymbol^{i}_{.j}}{\elementcoordinatevector}\delby{\elementcoordinate{r}}{\coordinate{i}}
  \delby{\elementcoordinate{s}}{\coordinate{k}}
\end{equation}
Note that for Laplace's equation with no conductivity or fibre fields
(\ie $\conductivitytensorsymbol^{i}_{.j}=\mixedkronecker{i}{.j}$ and
thus $i=j$) we have
\begin{equation}
  \fnof{\gamma^{rs}}{\elementcoordinatevector}=\generalmetrictensorsymbol^{kj}
  \delby{\elementcoordinate{r}}{\coordinate{j}}\delby{\elementcoordinate{s}}{\coordinate{k}}
  \label{eqn:DiffusionOperatorGammaDefinition2}
\end{equation}
and that for rectangular-Cartesian coordinates systems
$\generalmetrictensorsymbol^{kj}=\sharpkronecker{k}{j}$ and thus $k=j$. This now gives
\begin{equation}
  \fnof{\gamma^{rs}}{\elementcoordinatevector}=\delby{\elementcoordinate{r}}{\coordinate{k}}
  \delby{\elementcoordinate{s}}{\coordinate{k}}=\fnof{\generalmetrictensorsymbol^{rs}}{\coordinatevector}
  \label{eqn:DiffusionOperatorGammaDefinition3}
\end{equation}
where $\generalmetrictensorsymbol^{rs}$ is the \emph{contravariant metric tensor} from $\coordinatevector$ to
$\elementcoordinatevector$ coordinates.

The flux matrix, $N^{\alpha\gamma}_{mo}$, is given by
\begin{equation}
  N^{\alpha\gamma}_{mo} = \gsf{m}{\alpha}\gsf{o}{\gamma}
  \gint{\vectr{0}}{\vectr{1}}{\gbfn{m}{\alpha}{\boundarycoordinatevector}
    \gbfn{o}{\gamma}{\boundarycoordinatevector}
    \abs{\jacobian{\Gamma}{\boundarycoordinatevector}}}{\boundarycoordinatevector}
\end{equation}

\subsection{\OpenCMISS fields}
\label{subsec:LaplaceOpenCMISSFields}

The following fields are used in the \OpenCMISS implementation of Laplace's equations.

\subsubsection{Equations set field}

An equations set field is not used for Laplace equations sets.

\subsubsection{Geometric field}

The geometric field definition for the coordinate vector
$\coordinatevector\in\rntopology{n}$, where $n$ is the number of dimensions,
is given in \tabref{tab:OpenCMISSGeometricFieldLaplaceEQS}.

\begin{table}[htb] \centering
  \begin{tabular}{|c|c|c|} \hline
    \emph{Field variable type} & \emph{Geometric field component} & \emph{Interpretation} \\ \hline \hline
    \compcode{FIELD\_U\_VARIABLE\_TYPE} & $1$ & $\coordinate{1}$ \\ 
    & \vdots & \vdots \\ 
    & $n$ & $\coordinate{n}$ \\ \hline
  \end{tabular}
  \caption{\OpenCMISS geometric field components for Laplace equation sets.}
  \label{tab:OpenCMISSGeometricFieldLaplaceEQS}
\end{table}

\subsubsection{Fibre field}

A fibre field can be optionally used to define the fibre coordinate
system rotation angles $\vectr{\alpha}\in\rntopology{n}$, where $n$ is
the number of dimensions, is given in
\tabref{tab:OpenCMISSFibreFieldLaplaceEQS}.

\begin{table}[htb] \centering
  \begin{tabular}{|c|c|c|} \hline
    \emph{Field variable type} & \emph{Fibre field component} & \emph{Interpretation} \\ \hline \hline
    \compcode{FIELD\_U\_VARIABLE\_TYPE} & $1$ & $\alpha^{1}$ \\ 
    & \vdots & \vdots \\ 
    & $n$ & $\alpha^{n}$ \\ \hline
  \end{tabular}
  \caption{\OpenCMISS fibre field components for Laplace equation sets.}
  \label{tab:OpenCMISSFibreFieldLaplaceEQS}
\end{table}

\subsubsection{Dependent field}

The dependent field defintion for $\fnof{u}{\coordinatevector}$ and
$\delby{\fnof{u}{\coordinatevector}}{\normal}$ are given in
\tabref{tab:OpenCMISSDependentFieldLaplaceEQS}.

\begin{table}[htb] \centering
  \begin{tabular}{|c|c|c|} \hline
    \emph{Field variable type} & \emph{Dependent field component} & \emph{Interpretation} \\ \hline \hline
    \compcode{FIELD\_U\_VARIABLE\_TYPE} & $1$ & $u$ \\ \hline \hline
    \compcode{FIELD\_DELUDELN\_VARIABLE\_TYPE} & $1$ & $q=\dotprod{\conductivitytensor\gradient{}{u}}{\normal}$ \\ \hline
  \end{tabular}
  \caption{\OpenCMISS dependent field components for Laplace equation sets.}
  \label{tab:OpenCMISSDependentFieldLaplaceEQS}
\end{table}
   
\subsubsection{Materials field}

For \eqnref{eqn:GeneralisedLaplaceEquation} the conductivity tensor,
$\fnof{\conductivitytensor}{\coordinatevector}$, is defined using the
materials field definition for $n$ dimensions is given in
\tabref{tab:OpenCMISSMaterialsFieldGenLaplaceEQS}. The conductivity
tensor is stored in Voigt form and $\numberVoigt{n}$ is the number of
Voigt terms for $n$ dimensions.

\begin{table}[htb] \centering
  \begin{tabular}{|c|c|c|} \hline
    \emph{Field variable type} & \emph{Material field component} & \emph{Interpretation} \\ \hline \hline
    \compcode{FIELD\_U\_VARIABLE\_TYPE} & $1$ & $\tilde{\bar{\conductivitytensorsymbol}}^{1}$ \\ 
    & \vdots & \vdots \\ 
    & $\numberVoigt{n}$ & $\tilde{\bar{\conductivitytensorsymbol}}^{\numberVoigt{n}}$ \\ \hline
  \end{tabular}
  \caption{\OpenCMISS materials field components for the generalised Laplace equation sets.}
  \label{tab:OpenCMISSMaterialsFieldGenLaplaceEQS}
\end{table}
   
\subsubsection{Analytic field}

The field definitions for the analytic field are given in \subsecref{subsec:LaplaceAnalytic}.

\subsection{Analytic Solutions}
\label{subsec:LaplaceAnalytic}

\subsubsection{Standard Laplace Two Dimensional Solution 1}

The first analytic solution to the standard Laplace's equation in two-dimensions is given by
\begin{equation}
  \fnof{u}{x,y}=x^{2}+2xy-y^{2}
  \label{eqn:StandardLaplaceTwoDAnalytic1}
\end{equation}

The gradient of \eqnref{eqn:StandardLaplaceTwoDAnalytic1} is
\begin{equation}
  \gradient{}{\fnof{u}{x,y}}=\begin{bmatrix}
  \delby{\fnof{u}{x,y}}{x} \\
  \delby{\fnof{u}{x,y}}{y}
  \end{bmatrix}=\begin{bmatrix}
  2x+2y \\
  2x-2y
  \end{bmatrix}
  \label{eqn:StandardLaplaceTwoDAnalyticGradient1}
\end{equation}

The Hessian of \eqnref{eqn:StandardLaplaceTwoDAnalytic1} is
\begin{equation}
  \hessian{}{\fnof{u}{x,y}}=\begin{bmatrix}
  \deltwosqby{\fnof{u}{x,y}}{x} & \deltwoby{\fnof{u}{x,y}}{x}{y} \\
  \deltwoby{\fnof{u}{x,y}}{y}{x} & \deltwosqby{\fnof{u}{x,y}}{y}
  \end{bmatrix}=\begin{bmatrix}
  2 & 2 \\
  2 & -2
  \end{bmatrix}
  \label{eqn:StandardLaplaceTwoDAnalyticHessian1}
\end{equation}

Thus we have
\begin{equation}
  \begin{aligned}
    \laplacian{}{\fnof{u}{x,y}}&=\deltwosqby{\fnof{u}{x,y}}{x}+\deltwosqby{\fnof{u}{x,y}}{y}\\
    &=2-2\\
    &=0
  \end{aligned}
\end{equation}
which shows that \eqnref{eqn:StandardLaplaceTwoDAnalytic1} satisfies the standard Laplace equation.

This analytic solution does not have an analytic field.

\subsubsection{Standard Laplace Two Dimensional Solution 2}
 
The second analytic solution to the standard Laplace's equation in two-dimensions is given by
\begin{equation}
  \fnof{u}{x,y}=\cosine{x}\hypecosine{y}
  \label{eqn:StandardLaplaceTwoDAnalytic2}
\end{equation}

The gradient of \eqnref{eqn:StandardLaplaceTwoDAnalytic2} is
\begin{equation}
  \gradient{}{\fnof{u}{x,y}}=\begin{bmatrix}
  \delby{\fnof{u}{x,y}}{x} \\
  \delby{\fnof{u}{x,y}}{y}
  \end{bmatrix}=\begin{bmatrix}
  -\sine{x}\hypecosine{y} \\
  \cosine{x}\hypesine{y}
  \end{bmatrix}
  \label{eqn:StandardLaplaceTwoDAnalyticGradient2}
\end{equation}

The Hessian of \eqnref{eqn:StandardLaplaceTwoDAnalytic2} is
\begin{equation}
  \hessian{}{\fnof{u}{x,y}}=\begin{bmatrix}
  \deltwosqby{\fnof{u}{x,y}}{x} & \deltwoby{\fnof{u}{x,y}}{x}{y} \\
  \deltwoby{\fnof{u}{x,y}}{y}{x} & \deltwosqby{\fnof{u}{x,y}}{y}
  \end{bmatrix}=\begin{bmatrix}
  -\cosine{x}\hypecosine{y} & -\sine{x}\hypesine{y} \\
  -\sine{x}\hypesine{y} & \cosine{x}\hypecosine{y}
  \end{bmatrix}
  \label{eqn:StandardLaplaceTwoDAnalyticHessian2}
\end{equation}

Thus we have
\begin{equation}
  \laplacian{}{\fnof{u}{x,y}}=\deltwosqby{\fnof{u}{x,y}}{x}+\deltwosqby{\fnof{u}{x,y}}{y}=-\cosine{x}\hypecosine{y}+
  \cosine{x}\hypecosine{y}=0
\end{equation}
which shows that \eqnref{eqn:StandardLaplaceTwoDAnalytic2} satisfies the standard Laplace equation.

This analytic solution does not have an analytic field.

\subsubsection{Generalised Laplace Two Dimensional Anisotropic Solution 1}

Consider the problem shown in \figref{fig:AnalyticLaplaceAnisoPlate}.

\epstexfigure{ClassicalField/svgs/anisoplate.eps_tex}{Anisotropic plate solution
  domain.}{Anisotropic plate solution domain.}{fig:AnalyticLaplaceAnisoPlate}{0.75}

For this test problem the conductivity tensor in fibre coordinates is
\begin{equation}
  \tilde{\conductivitytensor}=\begin{bmatrix}
    \tilde{\conductivitytensorsymbol}_{t} & 0 \\ 
    0 & \tilde{\conductivitytensorsymbol}_{n}
  \end{bmatrix}
\end{equation}

The conductivity tensor in reference coordinates can be calculated
from the conductivity tensor in fibre coordinates by tensor
transformation. From \figref{fig:AnalyticLaplaceAnisoPlate} we have
\begin{equation}
  \begin{aligned}
    \tilde{x}&=\cosine{\theta}x+\sine{\theta}y\\
    \tilde{y}&=-\sine{\theta}x+\cosine{\theta}y
  \end{aligned}
  \label{eqn:AnisoPlateFibreFromSpatialCoordinates}
\end{equation}
and
\begin{equation}
  \begin{aligned}
    x&=\cosine{\theta}\tilde{x}-\sine{\theta}\tilde{y}\\
    y&=\sine{\theta}\tilde{x}+\cosine{\theta}\tilde{y}
  \end{aligned}
  \label{eqn:AnisoPlateSpatialFromFibreCoordinates}
\end{equation}

As $\tilde{\conductivitytensor}$ is a mixed tensor \ie
$\tilde{\conductivitytensor}=\tilde{\conductivitytensorsymbol}^{a}_{.b}\,\tensorprodtwo{\tilde{\generalbasevector}_{a}}{\tilde{\generalbasevector}^{b}}$,
then we need to use the transformation rule given in
\eqnref{eqn:TransformationRuleMixedContraCovariantSecondOrderTensor}
\ie
\begin{equation}
  \conductivitytensorsymbol^{i}_{.j}=\delby{x^{i}}{\tilde{x}^{a}}\delby{\tilde{x}^{b}}{x^{j}}\tilde{\conductivitytensorsymbol}^{a}_{.b}
  \label{eqn:AnsioPlateConductivityTensorTransformation}
\end{equation}

The transformation components can be found from differentiating
\eqnrefs{eqn:AnisoPlateFibreFromSpatialCoordinates}{eqn:AnisoPlateSpatialFromFibreCoordinates}
\ie
\begin{equation}
  \begin{aligned}
    \begin{bmatrix}
      \delby{\tilde{x}}{x} & \delby{\tilde{y}}{x} \\
      \delby{\tilde{x}}{y} & \delby{\tilde{y}}{y}
    \end{bmatrix} &=
    \begin{bmatrix}
      \cosine{\theta} & -\sine{\theta} \\
      \sine{\theta} & \cosine{\theta}
    \end{bmatrix} &\qquad&&
    \begin{bmatrix}
      \delby{x}{\tilde{x}} & \delby{y}{\tilde{x}} \\
      \delby{x}{\tilde{y}} & \delby{y}{\tilde{y}}
    \end{bmatrix}&=
    \begin{bmatrix}
      \cosine{\theta} & \sine{\theta} \\
      -\sine{\theta} & \cosine{\theta}
    \end{bmatrix}
  \end{aligned}
\end{equation}

We thus have from \eqnref{eqn:AnsioPlateConductivityTensorTransformation}
\begin{equation}
  \begin{aligned}
    \conductivitytensorsymbol^{1}_{1}&=
    \delby{x}{\tilde{x}}\delby{\tilde{x}}{x}\tilde{\conductivitytensorsymbol}^{1}_{1}
    +\delby{x}{\tilde{x}}\delby{\tilde{y}}{x}\tilde{\conductivitytensorsymbol}^{1}_{2}
    +\delby{x}{\tilde{y}}\delby{\tilde{x}}{x}\tilde{\conductivitytensorsymbol}^{2}_{1}
    +\delby{x}{\tilde{y}}\delby{\tilde{y}}{x}\tilde{\conductivitytensorsymbol}^{2}_{2} \\
    &=\cosine{\theta}\cosine{\theta}\tilde{\conductivitytensorsymbol}_{t}
    +\cosine{\theta}-\sine{\theta}.0
    -\sine{\theta}\cosine{\theta}.0
    -\sine{\theta}-\sine{\theta}\tilde{\conductivitytensorsymbol}_{n} \\
    \conductivitytensorsymbol^{1}_{2}&=
    \delby{x}{\tilde{x}}\delby{\tilde{x}}{y}\tilde{\conductivitytensorsymbol}^{1}_{1}
    +\delby{x}{\tilde{x}}\delby{\tilde{y}}{y}\tilde{\conductivitytensorsymbol}^{1}_{2}
    +\delby{x}{\tilde{y}}\delby{\tilde{x}}{y}\tilde{\conductivitytensorsymbol}^{2}_{1}
    +\delby{x}{\tilde{y}}\delby{\tilde{y}}{y}\tilde{\conductivitytensorsymbol}^{2}_{2} \\
    &=\cosine{\theta}\sine{\theta}\tilde{\conductivitytensorsymbol}_{t}
    +\cosine{\theta}\cosine{\theta}.0
    -\sine{\theta}\sine{\theta}.0
    -\sine{\theta}\cosine{\theta}\tilde{\conductivitytensorsymbol}_{n} \\
    \conductivitytensorsymbol^{2}_{1}&=
    \delby{y}{\tilde{x}}\delby{\tilde{x}}{x}\tilde{\conductivitytensorsymbol}^{1}_{1}
    +\delby{y}{\tilde{x}}\delby{\tilde{y}}{x}\tilde{\conductivitytensorsymbol}^{1}_{2}
    +\delby{y}{\tilde{y}}\delby{\tilde{x}}{x}\tilde{\conductivitytensorsymbol}^{2}_{1}
    +\delby{y}{\tilde{y}}\delby{\tilde{y}}{x}\tilde{\conductivitytensorsymbol}^{2}_{2} \\
    &=\sine{\theta}\cosine{\theta}\tilde{\conductivitytensorsymbol}_{t}
    +\sine{\theta}-\sine{\theta}.0
    +\cosine{\theta}\cosine{\theta}.0
    +\cosine{\theta}-\sine{\theta}\tilde{\conductivitytensorsymbol}_{n} \\
    \conductivitytensorsymbol^{2}_{2}&=
    \delby{y}{\tilde{x}}\delby{\tilde{x}}{y}\tilde{\conductivitytensorsymbol}^{1}_{1}
    +\delby{y}{\tilde{x}}\delby{\tilde{y}}{y}\tilde{\conductivitytensorsymbol}^{1}_{2}
    +\delby{y}{\tilde{y}}\delby{\tilde{x}}{y}\tilde{\conductivitytensorsymbol}^{2}_{1}
    +\delby{y}{\tilde{y}}\delby{\tilde{y}}{y}\tilde{\conductivitytensorsymbol}^{2}_{2} \\
    &=\sine{\theta}\sine{\theta}\tilde{\conductivitytensorsymbol}_{t}
    +\sine{\theta}\cosine{\theta}.0
    +\cosine{\theta}\sine{\theta}.0
    +\cosine{\theta}\cosine{\theta}\tilde{\conductivitytensorsymbol}_{n} \\
  \end{aligned}
\end{equation}

Hence
\begin{equation}
  \conductivitytensor= \begin{bmatrix}
    \conductivitytensorsymbol^{1}_{1} & \conductivitytensorsymbol^{2}_{1} \\
    \conductivitytensorsymbol^{1}_{2} & \conductivitytensorsymbol^{2}_{2} 
  \end{bmatrix} = \begin{bmatrix}
    \tilde{\conductivitytensorsymbol}_{t}\cosinesq{\theta}+\tilde{\conductivitytensorsymbol}_{n}\sinesq{\theta} & 
    \pbrac{\tilde{\conductivitytensorsymbol}_{t}-\tilde{\conductivitytensorsymbol}_{n}}\sine{\theta}\cosine{\theta} \\
    \pbrac{\tilde{\conductivitytensorsymbol}_{t}-\tilde{\conductivitytensorsymbol}_{n}}\sine{\theta}\cosine{\theta} &
    \tilde{\conductivitytensorsymbol}_{t}\sinesq{\theta}+\tilde{\conductivitytensorsymbol}_{n}\cosinesq{\theta}
  \end{bmatrix} 
  \label{eqn:AnisoPlateTransformedConductivty}
\end{equation}

The generalised Laplace equation for this problem in reference coordinates is
hence given by
\begin{equation}
  \divergence{}{\pbrac{\conductivitytensor\gradient{}u}}=
  \generalmetrictensorsymbol^{11}\conductivitytensorsymbol^{1}_{1}\deltwosqby{u}{x}
  +\generalmetrictensorsymbol^{11}\conductivitytensorsymbol^{2}_{1}\deltwoby{u}{x}{y}
  +\generalmetrictensorsymbol^{22}\conductivitytensorsymbol^{1}_{2}\deltwoby{u}{y}{x}
  +\generalmetrictensorsymbol^{22}\conductivitytensorsymbol^{2}_{2}\deltwosqby{u}{y}
  =0
  \label{eqn:AnisoPlate2DRCGenLaplace}
\end{equation}

\Eqnref{eqn:AnisoPlate2DRCGenLaplace} cannot be solved using traditional eigenfunction
expansions as it is non-separable. In fact, for an arbitrary domain and
arbitrary boundary conditions, \eqnref{eqn:AnisoPlate2DRCGenLaplace} is extremely
difficult to solve. It can be solved, however, by realising that from the
definition of $\conductivitytensorsymbol^{i}_{.j}$ in \eqnref{eqn:AnisoPlateTransformedConductivty} the
equation is elliptic everywhere in the solution domain. From
\citet{clements:1981}, a system of second order elliptic partial
differential equations is of the form
\begin{equation}
  a^{ijkl}\deltwoby{u_{k}}{x^{j}}{x^{l}}=0
  \label{eqn:General2ndOrderEllipticPDE}
\end{equation}
where $u_{k}$ are complex-valued functions of the dependent variables
$x^{1}$ and $x^{2}$ and $i,k=1,\ldots,N$. The $a^{ijkl}$ are real constants
which satisfy the symmetry condition $a^{ijkl}=a^{klij}$ and, since the system
is elliptic, satisfy $a^{ijkl}\xi_{ij}\xi_{kl}>0$ for every non-zero $N\times
2$ real matrix $\xi_{ij}$.

Real solutions to \eqnref{eqn:General2ndOrderEllipticPDE} may be written in
the form 
\begin{equation}
  u_{k}=\dsum_{\alpha}A_{k\alpha}\fnof{f_{\alpha}}{z_{\alpha}}+
  \dsum_{\alpha}\overline{A_{k\alpha}}\overline{\fnof{f_{\alpha}}{z_{\alpha}}}
\end{equation}
where $\alpha=1,\hdots,N$, $\fnof{f_{\alpha}}{z_{\alpha}}$ are arbitrary
analytic functions of a complex variable $z_{\alpha}$,
$\overline{\fnof{f_{\alpha}}{z_{\alpha}}}$ the complex conjugate of the
function $\fnof{f_{\alpha}}{z_{\alpha}}$, $A_{k\alpha}$ are complex constants
(to be determined), $z_{\alpha}=x^{1}+\tau_{\alpha} x^{2}$ and $\tau_{\alpha}$
are complex constants given by
\begin{equation}
  \det\sqbrac{a^{i1k1}+a^{i1k2}\tau+a^{i2k1}\tau+a^{i2k2}\tau^{2}}=0
\end{equation}

Comparing \eqnref{eqn:AnisoPlate2DRCGenLaplace} with
\eqnref{eqn:General2ndOrderEllipticPDE} it can be seen that $N=1$ and
$a^{1i1j}=\generalmetrictensorsymbol^{kj}\conductivitytensorsymbol^{i}_{k}=\conductivitytensorsymbol^{ij}$
and thus $\tau$ is given by
\begin{equation}
  \tau=\dfrac{-\conductivitytensorsymbol^{12}+
    \complex{i}\sqrt{\conductivitytensorsymbol^{11}\conductivitytensorsymbol^{22}-\conductivitytensorsymbol^{{12}^{2}}}}
             {\conductivitytensorsymbol^{22}}
             =\dfrac{-\conductivitytensorsymbol^{12}}{\conductivitytensorsymbol^{22}}+
             \dfrac{\complex{i}\sqrt{
                 \conductivitytensorsymbol^{11}\conductivitytensorsymbol^{22}-
                 \conductivitytensorsymbol^{{12}^{2}}}}{\conductivitytensorsymbol^{22}}
             =-\lambda_{1}+\complex{i}\lambda_{2}
\end{equation}
where $\complex{i}$ is the square root of $-1$. With this definition it can be seen
that
\begin{equation}
  z=x+\tau y=\pbrac{x-\lambda_{1}y}+\complex{i}\lambda_{2}y
\end{equation}

From \citet{clements:1981} $A_{11}=1$ for this problem and hence a
solution to \eqnref{eqn:AnisoPlate2DRCGenLaplace} can be found by specifying an
arbitrary analytic function $\fnof{f}{z}$.

For the test problem in this chapter the analytic function is chosen to be
$\fnof{f}{z}=e^{z}$. Thus the complete analytic solution is given by
\begin{equation}
  \begin{split}
    \fnof{u}{x,y}&=\fnof{f}{z}+\overline{\fnof{f}{z}} \\
    &= e^{\pbrac{x-\lambda_{1}y}+\complex{i}\lambda_{2}y}+
    \overline{e^{\pbrac{x-\lambda_{1}y}+\complex{i}\lambda_{2}y}} \\
    &= e^{\pbrac{x-\lambda_{1}y}}\pbrac{\cosine{\lambda_{2}y}+\complex{i}
      \sine{\lambda_{2}y}}+e^{\pbrac{x-\lambda_{1}y}}
    \pbrac{\cosine{\lambda_{2}y}-\complex{i}\sine{\lambda_{2}y}} \\
    &= 2e^{x}e^{-\lambda_{1}{y}}\cosine{\lambda_{2}y}
  \end{split}
  \label{eqn:GeneralisedLaplaceTwoDAnalytic1}
\end{equation}


The gradient of \eqnref{eqn:GeneralisedLaplaceTwoDAnalytic1} is
\begin{equation}
  \begin{aligned}
    \gradient{}{\fnof{u}{x,y}}&=\begin{bmatrix}
    \delby{\fnof{u}{x,y}}{x} \\
    \delby{\fnof{u}{x,y}}{y}
    \end{bmatrix}=\begin{bmatrix}
    2e^{x}e^{-\lambda_{1}{y}}\cosine{\lambda_{2}y} \\
    2e^{x}\pbrac{e^{-\lambda_{1}{y}}.-\sine{\lambda_{2}y}.\lambda_{2}-\lambda_{1}e^{-\lambda_{1}{y}}\cosine{\lambda_{2}y}}
    \end{bmatrix} \\
    &=\begin{bmatrix}
    2e^{x}e^{-\lambda_{1}{y}}\cosine{\lambda_{2}y} \\
    -2e^{x}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+\lambda_{1}\cosine{\lambda_{2}y}}
    \end{bmatrix}
  \end{aligned}
  \label{eqn:GeneralisedLaplaceTwoDAnalyticGradient1}
\end{equation}

The Hessian of \eqnref{eqn:GeneralisedLaplaceTwoDAnalytic1} is
\begin{equation}
  \begin{aligned}
    \hessian{}{\fnof{u}{x,y}}&=\begin{bmatrix}
    \deltwosqby{\fnof{u}{x,y}}{x} & \deltwoby{\fnof{u}{x,y}}{x}{y} \\
    \deltwoby{\fnof{u}{x,y}}{y}{x} & \deltwosqby{\fnof{u}{x,y}}{y}
    \end{bmatrix} \\
    &=\begin{bmatrix}
    2e^{x}e^{-\lambda_{1}{y}}\cosine{\lambda_{2}y} &
    -2e^{x}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+\lambda_{1}\cosine{\lambda_{2}y}} \\
    -2e^{x}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+\lambda_{1}\cosine{\lambda_{2}y}} &
    \begin{matrix}
      -2e^{x}\left(e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}^{2}\cosine{\lambda_{2}y}-\lambda_{1}\lambda_{2}\sine{\lambda_{2}y}}\right.\\
      \hfil{}\left.-\lambda_{1}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+\lambda_{1}\cosine{\lambda_{2}y}}\right)
    \end{matrix}\end{bmatrix}\\
    &=\begin{bmatrix}
    2e^{x}e^{-\lambda_{1}{y}}\cosine{\lambda_{2}y} &
    -2e^{x}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+\lambda_{1}\cosine{\lambda_{2}y}} \\
    -2e^{x}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+\lambda_{1}\cosine{\lambda_{2}y}} &
    \begin{matrix}
      -2\lambda_{2}e^{x}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\cosine{\lambda_{2}y}-\lambda_{1}\sine{\lambda_{2}y}}\\
      \hfil{}+2\lambda_{1}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+\lambda_{1}\cosine{\lambda_{2}y}}
    \end{matrix}
    \end{bmatrix}
  \end{aligned}
  \label{eqn:GeneralisedLaplaceTwoDAnalyticHessian1}
\end{equation}

Now we have $\lambda_{1}=\dfrac{\conductivitytensorsymbol^{12}}{\conductivitytensorsymbol^{22}}$ and
$\lambda_{2}=\dfrac{\sqrt{\conductivitytensorsymbol^{11}\conductivitytensorsymbol^{22}-\conductivitytensorsymbol^{{12}^{2}}}}{\conductivitytensorsymbol^{22}}$
and so, rearranging, we have
\begin{equation}
  \conductivitytensorsymbol^{22}=\dfrac{\conductivitytensorsymbol^{12}}{\lambda_{1}}
\end{equation}
and
\begin{equation}
  \begin{aligned}
    \conductivitytensorsymbol^{11}&=\dfrac{\conductivitytensorsymbol^{{22}^{2}}\lambda_{2}^{2}+
      \conductivitytensorsymbol^{{12}^{2}}}{\conductivitytensorsymbol^{22}}\\
    &=\conductivitytensorsymbol^{22}\lambda_{2}^{2}+\conductivitytensorsymbol^{12}\lambda_{11}\\
    &=\dfrac{\conductivitytensorsymbol^{12}\lambda_{2}^{2}}{\lambda_{1}}+\conductivitytensorsymbol^{12}\lambda_{11}\\
    &=\conductivitytensorsymbol^{12}\dfrac{\pbrac{\lambda_{1}^{2}+\lambda_{2}^{2}}}{\lambda_{1}}
  \end{aligned}
\end{equation}

Thus we have
\begin{equation}
  \begin{aligned}
    \divergence{}{\pbrac{\conductivitytensor\gradient{}\fnof{u}{x,y}}}&=
    \generalmetrictensorsymbol^{11}\conductivitytensorsymbol^{1}_{1}\deltwosqby{\fnof{u}{x,y}}{x}
    +\generalmetrictensorsymbol^{11}\conductivitytensorsymbol^{2}_{1}\deltwoby{\fnof{u}{x,y}}{y}{x}
    +\generalmetrictensorsymbol^{22}\conductivitytensorsymbol^{1}_{2}\deltwoby{\fnof{u}{x,y}}{x}{y}
    +\generalmetrictensorsymbol^{22}\conductivitytensorsymbol^{2}_{2}\deltwosqby{\fnof{u}{x,y}}{y}\\
    &=\conductivitytensorsymbol^{12}\dfrac{\pbrac{\lambda_{1}^{2}+\lambda_{2}^{2}}}{\lambda_{1}}
    \pbrac{2e^{x}e^{-\lambda_{1}{y}}\cosine{\lambda_{2}y}}+
    2\conductivitytensorsymbol^{12}\pbrac{-2e^{x}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+
        \lambda_{1}\cosine{\lambda_{2}y}}}\\
    &\quad+\dfrac{\conductivitytensorsymbol^{12}}{\lambda_{1}}
    \pbrac{-2\lambda_{2}e^{x}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\cosine{\lambda_{2}y}-\lambda_{1}\sine{\lambda_{2}y}}+
      2\lambda_{1}e^{-\lambda_{1}{y}}\pbrac{\lambda_{2}\sine{\lambda_{2}y}+\lambda_{1}\cosine{\lambda_{2}y}}}\\
    &=2\conductivitytensorsymbol^{12}e^{x}e^{-\lambda_{1}y}\left[
      \lambda_{1}\cosine{\lambda_{2}y}
      +\dfrac{\lambda_{2}^{2}}{\lambda_{1}}\cosine{\lambda_{2}y}
      -2\lambda_{2}\sine{\lambda_{2}y}
      -2\lambda_{1}\cosine{\lambda_{2}y}\right.\\
      &\quad\left.-\dfrac{\lambda_{2}^{2}}{\lambda_{1}}\cosine{\lambda_{2}y}
      +\lambda_{2}\sine{\lambda_{2}y}
      +\lambda_{2}\sine{\lambda_{2}y}
      +\lambda_{1}\cosine{\lambda_{2}y}\right]\\
    &=2\conductivitytensorsymbol^{12}e^{x}e^{-\lambda_{1}y}\left[2\lambda_{1}\cosine{\lambda_{2}y}-2\lambda_{1}\cosine{\lambda_{2}y}
      \right.\\
      &\quad\left.-2\lambda_{2}\sine{\lambda_{2}y}+2\lambda_{2}\sine{\lambda_{2}y}
      +\dfrac{\lambda_{2}^{2}}{\lambda_{1}}\cosine{\lambda_{2}y}
      -\dfrac{\lambda_{2}^{2}}{\lambda_{1}}\cosine{\lambda_{2}y}\right]\\
    &=2\conductivitytensorsymbol^{12}e^{x}e^{-\lambda_{1}y}\sqbrac{0}\\
    &=0
  \end{aligned}
\end{equation}
which shows that \eqnref{eqn:GeneralisedLaplaceTwoDAnalytic1} satisfies the generalised Laplace equation.

The analytic field component definitions in \OpenCMISS are shown in
\tabref{tab:OpenCMISSAnalyticFieldGeneralisedLaplaceEquationTwoDim1}.

\begin{table}[htb] \centering
  \begin{tabular}{|c|c|} \hline
    \emph{Analytic constant} & \emph{Analytic field component} \\ \hline \hline
    $\tilde{\conductivitytensorsymbol}_{t}$ & $1$ \\ 
    $\tilde{\conductivitytensorsymbol}_{n}$ & $2$ \\
    $\theta$ & $3$ \\ \hline
  \end{tabular}
  \caption{\OpenCMISS analytic field components for the \twod generalised Laplace equation
    analytic function 1.}
  \label{tab:OpenCMISSAnalyticFieldGeneralisedLaplaceEquationTwoDim1}
\end{table}

We can consider a worked example for the domain shown in \figref{fig:FEMTwoDGenLaplaceDomainExample}

\epstexfigure{ClassicalField/svgs/FEMTwoDGenLaplaceDomain.eps_tex}{Generalised
  Laplace example domain.}{Generalised Laplace example domain of a
  plate of length $L$ and height $H$ divided into $4\times 2=8$
  elements. The plate has a fibre field at an angle of $\theta$ to the
  $x$ axis.}{fig:FEMTwoDGenLaplaceDomainExample}{0.66}

For the case when $H=\dfrac{L}{2}$, $N_{y}=\dfrac{N_{x}}{2}$, $\conductivitytensorsymbol_{t}=3$, $\conductivitytensorsymbol_{n}=1$, and $\theta=30\degree$ we have that

\begin{align}
  \conductivitytensor&=\begin{bmatrix}
  \conductivitytensorsymbol_{t}\cosinesq{\theta}+\conductivitytensorsymbol_{n}\sinesq{\theta} & 
  \pbrac{\conductivitytensorsymbol_{t}-\conductivitytensorsymbol_{n}}\sine{\theta}\cosine{\theta} \\
  \pbrac{\conductivitytensorsymbol_{t}-\conductivitytensorsymbol_{n}}\sine{\theta}\cosine{\theta} &
  \conductivitytensorsymbol_{t}\sinesq{\theta}+\conductivitytensorsymbol_{n}\cosinesq{\theta}
  \end{bmatrix} = \begin{bmatrix}
    \conductivitytensorsymbol^{1}_{1} & \conductivitytensorsymbol^{1}_{2} \\
    \conductivitytensorsymbol^{2}_{1} & \conductivitytensorsymbol^{2}_{2} 
  \end{bmatrix} \\
  &=\begin{bmatrix}
  3\pbrac{\frac{\sqrt{3}}{2}}^{2}+1\pbrac{\frac{1}{2}}^{2} & 
  \pbrac{3-1}\pbrac{\frac{1}{2}}\pbrac{\frac{\sqrt{3}}{2}} \\
  \pbrac{3-1}\pbrac{\frac{1}{2}}\pbrac{\frac{\sqrt{3}}{2}} &
  3\pbrac{\frac{1}{2}}^{2}+1\pbrac{\frac{\sqrt{3}}{2}}^{2}
  \end{bmatrix} = \begin{bmatrix}
    \frac{5}{2} & \frac{\sqrt{3}}{2} \\
    \frac{\sqrt{3}}{2} & \frac{3}{2}
  \end{bmatrix} 
  \label{eqn:FEMTwoDGenLaplaceDomainConductivity}
\end{align}

Now from \eqnref{eqn:FEMTwoDGenLaplaceSquareElementStiffnessMatrix} we have
\begin{equation}
  K_{mn}=\begin{bmatrix}
  \frac{4\conductivitytensorsymbol^{11}+3\pbrac{\conductivitytensorsymbol^{21}+
      \conductivitytensorsymbol^{12}}+4\conductivitytensorsymbol^{22}}{12} &
  \frac{-4\conductivitytensorsymbol^{11}+3\pbrac{\conductivitytensorsymbol^{21}-
      \conductivitytensorsymbol^{12}}+2\conductivitytensorsymbol^{22}}{12} &
  \frac{2\conductivitytensorsymbol^{11}-3\pbrac{\conductivitytensorsymbol^{21}-
      \conductivitytensorsymbol^{12}}-4\conductivitytensorsymbol^{22}}{12} &
  \frac{-2\conductivitytensorsymbol^{11}-3\pbrac{\conductivitytensorsymbol^{21}+
        \conductivitytensorsymbol^{12}}-2\conductivitytensorsymbol^{22}}{12} \\
  \frac{-4\conductivitytensorsymbol^{11}+3\pbrac{\conductivitytensorsymbol^{21}-
      \conductivitytensorsymbol^{12}}+2\conductivitytensorsymbol^{22}}{12} &
  \frac{4\conductivitytensorsymbol^{11}-3\pbrac{\conductivitytensorsymbol^{21}+
      \conductivitytensorsymbol^{12}}+4\conductivitytensorsymbol^{22}}{12} &
  \frac{-2\conductivitytensorsymbol^{11}+3\pbrac{\conductivitytensorsymbol^{21}+
        \conductivitytensorsymbol^{12}}-2\conductivitytensorsymbol^{22}}{12} &
  \frac{2\conductivitytensorsymbol^{11}+3\pbrac{\conductivitytensorsymbol^{21}-
        \conductivitytensorsymbol^{12}}-4\conductivitytensorsymbol^{22}}{12} \\
  \frac{2\conductivitytensorsymbol^{11}-3\pbrac{\conductivitytensorsymbol^{21}-
      \conductivitytensorsymbol^{12}}-4\conductivitytensorsymbol^{22}}{12} &
  \frac{-2\conductivitytensorsymbol^{11}+3\pbrac{\conductivitytensorsymbol^{21}+
        \conductivitytensorsymbol^{12}}-2\conductivitytensorsymbol^{22}}{12} &
  \frac{4\conductivitytensorsymbol^{11}-3\pbrac{\conductivitytensorsymbol^{21}+
      \conductivitytensorsymbol^{12}}+4\conductivitytensorsymbol^{22}}{12} &
  \frac{-4\conductivitytensorsymbol^{11}-3\pbrac{\conductivitytensorsymbol^{21}-
      \conductivitytensorsymbol^{12}}+2\conductivitytensorsymbol^{22}}{12} \\
  \frac{-2\conductivitytensorsymbol^{11}-3\pbrac{\conductivitytensorsymbol^{21}+
        \conductivitytensorsymbol^{12}}-2\conductivitytensorsymbol^{22}}{12} &
  \frac{2\conductivitytensorsymbol^{11}+3\pbrac{\conductivitytensorsymbol^{21}-
        \conductivitytensorsymbol^{12}}-4\conductivitytensorsymbol^{22}}{12}&
  \frac{-4\conductivitytensorsymbol^{11}-3\pbrac{\conductivitytensorsymbol^{21}-
      \conductivitytensorsymbol^{12}}+2\conductivitytensorsymbol^{22}}{12} &
  \frac{4\conductivitytensorsymbol^{11}+3\pbrac{\conductivitytensorsymbol^{21}+
      \conductivitytensorsymbol^{12}}+4\conductivitytensorsymbol^{22}}{12}
  \end{bmatrix}
\end{equation}

With these conductivities and fibre angle the elemental stiffness matrix becomes
\begin{equation}
  K_{mn}=\begin{bmatrix}
  \frac{16+3\sqrt{3}}{12} & -\frac{7}{12} & -\frac{1}{12} & \frac{-8-3\sqrt{3}}{12} \\
  -\frac{7}{12} & \frac{16-3\sqrt{3}}{12} & \frac{-8+3\sqrt{3}}{12} & -\frac{1}{12} \\
  -\frac{1}{12} & \frac{-8+3\sqrt{3}}{12} & \frac{16-3\sqrt{3}}{12} & -\frac{7}{12} \\
  \frac{-8-3\sqrt{3}}{12} & -\frac{1}{12} & -\frac{7}{12} & \frac{16+3\sqrt{3}}{12}
  \end{bmatrix} 
\end{equation}


\subsubsection{Standard Laplace Three Dimensional Solution 1}

The first analytic solution to the standard Laplace's equation in three-dimensions is given by
\begin{equation}
  \fnof{u}{x,y,z}=x^{2}+y^{2}-2z^{2}
  \label{eqn:StandardLaplaceThreeDAnalytic1}
\end{equation}

The gradient of \eqnref{eqn:StandardLaplaceThreeDAnalytic1} is
\begin{equation}
  \gradient{}{\fnof{u}{x,y,z}}=\begin{bmatrix}
  \delby{\fnof{u}{x,y,z}}{x} \\
  \delby{\fnof{u}{x,y,z}}{y} \\
  \delby{\fnof{u}{x,y,z}}{z}
  \end{bmatrix}=\begin{bmatrix}
  2x \\
  2y \\
  -4z
  \end{bmatrix}
  \label{eqn:StandardLaplaceThreeDAnalyticGradient1}
\end{equation}

The Hessian of \eqnref{eqn:StandardLaplaceThreeDAnalytic1} is
\begin{equation}
  \hessian{}{\fnof{u}{x,y,z}}=\begin{bmatrix}
  \deltwosqby{\fnof{u}{x,y,z}}{x} & \deltwoby{\fnof{u}{x,y,z}}{x}{y} & \deltwoby{\fnof{u}{x,y,z}}{x}{z} \\
  \deltwoby{\fnof{u}{x,y,z}}{y}{x} & \deltwosqby{\fnof{u}{x,y,z}}{y} & \deltwoby{\fnof{u}{x,y,z}}{y}{z} \\
  \deltwoby{\fnof{u}{x,y,z}}{z}{x} & \deltwoby{\fnof{u}{x,y,z}}{z}{y} & \deltwosqby{\fnof{u}{x,y,z}}{z}
  \end{bmatrix}=\begin{bmatrix}
  2 & 0 & 0 \\
  0 & 2 & 0 \\
  0 & 0 & -4 \\
  \end{bmatrix}
  \label{eqn:StandardLaplaceThreeDAnalyticHessian1}
\end{equation}

Thus we have
\begin{equation}
  \begin{aligned}
    \laplacian{}{\fnof{u}{x,y,z}}&=\deltwosqby{\fnof{u}{x,y,z}}{x}+\deltwosqby{\fnof{u}{x,y,z}}{y}+\deltwosqby{\fnof{u}{x,y,z}}{z} \\
    &=2+2-4\\
    &=0
  \end{aligned}
\end{equation}
which shows that \eqnref{eqn:StandardLaplaceThreeDAnalytic1} satisfies the standard Laplace equation.

This analytic solution does not have an analytic field.

\subsubsection{Standard Laplace Three Dimensional Solution 2}
 
The second analytic solution to the standard Laplace's equation in three-dimensions is given by
\begin{equation}
  \fnof{u}{x,y,z}=\cosine{x}\hypecosine{y}z
  \label{eqn:StandardLaplaceThreeDAnalytic2}
\end{equation}

The gradient of \eqnref{eqn:StandardLaplaceThreeDAnalytic2} is
\begin{equation}
  \gradient{}{\fnof{u}{x,y,z}}=\begin{bmatrix}
  \delby{\fnof{u}{x,y,z}}{x} \\
  \delby{\fnof{u}{x,y,z}}{y} \\
  \delby{\fnof{u}{x,y,z}}{z}
  \end{bmatrix}=\begin{bmatrix}
  -\sine{x}\hypecosine{y}z \\
  \cosine{x}\hypesine{y}z \\
  \cosine{x}\hypecosine{y}
  \end{bmatrix}
  \label{eqn:StandardLaplaceThreeDAnalyticGradient2}
\end{equation}

The Hessian of \eqnref{eqn:StandardLaplaceThreeDAnalytic2} is
\begin{equation}
  \begin{aligned}
    \hessian{}{\fnof{u}{x,y,z}}&=\begin{bmatrix}
    \deltwosqby{\fnof{u}{x,y,z}}{x} & \deltwoby{\fnof{u}{x,y,z}}{x}{y} & \deltwoby{\fnof{u}{x,y,z}}{x}{z} \\
    \deltwoby{\fnof{u}{x,y,z}}{y}{x} & \deltwosqby{\fnof{u}{x,y,z}}{y} & \deltwoby{\fnof{u}{x,y,z}}{y}{z} \\
    \deltwoby{\fnof{u}{x,y,z}}{z}{x} & \deltwoby{\fnof{u}{x,y,z}}{z}{y} & \deltwosqby{\fnof{u}{x,y,z}}{z}
    \end{bmatrix}\\
    &=\begin{bmatrix}
    -\cosine{x}\hypecosine{y}z & -\sine{x}\hypesine{y}z & -\sine{x}\hypecosine{y} \\
    -\sine{x}\hypesine{y}z & \cosine{x}\hypecosine{y}z & \cosine{x}\hypesine{y} \\
    -\sine{x}\hypecosine{y} & \cosine{x}\hypesine{y} & 0 \\
    \end{bmatrix}
  \end{aligned}
  \label{eqn:StandardLaplaceThreeDAnalyticHessian2}
\end{equation}

Thus we have
\begin{equation}
  \begin{aligned}
    \laplacian{}{\fnof{u}{x,y,z}}&=\deltwosqby{\fnof{u}{x,y,z}}{x}+\deltwosqby{\fnof{u}{x,y,z}}{y}+\deltwosqby{\fnof{u}{x,y,z}}{z}\\
    &=-\cosine{x}\hypecosine{y}z+\cosine{x}\hypecosine{y}z+0\\
    &=0
  \end{aligned}
\end{equation}
which shows that \eqnref{eqn:StandardLaplaceThreeDAnalytic2} satisfies the standard Laplace equation.

This analytic solution does not have an analytic field.

% \subsection{Coded OpenCMISS formulation:}
% Finally, we use the Gaussian quadrature rule (see Section~??? - still to be written), 
% usually stated as a weighted sum of function values at specified Gauss points within the domain of integration. An $n$-point Gaussian quadrature rule yields an exact result for polynomials of degree $2n-1$ or less by a suitable choice of the points $x_i$ and weights $g_i$ for $i = 1,...,n$. Consequently, the formulation implemented can be derived from Equation (\ref{eqn:elementalfemlhs2}) as: 
% \begin{equation}
%   \boxed{
%   \dsum_{e=1}^{E}\nodedof{\phi}{\alpha}{u}\gsf{(\alpha)}{(u)} \gsf{(\beta)}{(v)}
%   \dsum_{i=1}^{n}
%   \left(\delby{\gbfn{\alpha}{u}{\elementcoordinatevector}}{\elementcoordinate{r}}
%   \delby{\gbfn{\beta}{v}{\elementcoordinatevector}}{\elementcoordinate{s}}\gamma^{rs}\abs{\fnof{\matr{J}}{\elementcoordinatevector}}
%   \right)(x_i)g_i
%   }
%   \label{eqn:Laplaceweightedresidualtensorform in OpenCMISS}
% \end{equation}


% \newpage
% \subsection{OpenCMISS implementation}

% For exemplification, we briefly discuss here a code snippet
% that evaluates the expression~(\ref{eqn:Laplaceweightedresidualtensorform in OpenCMISS}):

% \lstset{ %
% language=Fortran,               % choose the language of the code
% basicstyle=\footnotesize,       % the size of the fonts that are used for the code
% numbers=left,                   % where to put the line-numbers
% numberstyle=\footnotesize,      % the size of the fonts that are used for the line-numbers
% stepnumber=1,                   % the step between two line-numbers. If it's 1 each line 
%                                 % will be numbered
% numbersep=5pt,                  % how far the line-numbers are from the code
% backgroundcolor=\color{white},  % choose the background color. You must add \usepackage{color}
% showspaces=false,               % show spaces adding particular underscores
% showstringspaces=false,         % underline spaces within strings
% showtabs=false,                 % show tabs within strings adding particular underscores
% frame=single,	                % adds a frame around the code
% tabsize=2,	                % sets default tabsize to 2 spaces
% captionpos=b,                   % sets the caption-position to bottom
% breaklines=true,                % sets automatic line breaking
% breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
% title=\lstname,                 % show the filename of files included with \lstinputlisting;
%                                 % also try caption instead of title
% escapeinside={\%*}{*)},         % if you want to add a comment within your code
% morekeywords={*,...}            % if you want to add more keywords to the set
% }




% {\footnotesize\tt
% \begin{lstlisting}
% SUBROUTINE LAPLACE_EQUATION_FINITE_ELEMENT_CALCULATE(EQUATIONS_SET,ELEMENT_NUMBER, ERR,ERROR,*)
%   DO ng=1,QUADRATURE_SCHEME%NUMBER_OF_GAUSS
%     RWG=EQUATIONS%INTERPOLATION%GEOMETRIC_INTERP_POINT_METRICS(FIELD_U_VARIABLE_TYPE)%PTR%JACOBIAN*QUADRATURE_SCHEME%GAUSS_WEIGHTS(ng)
%     mhs=0          
%     !Loop over element rows
%     DO mh=1,FIELD_VARIABLE%NUMBER_OF_COMPONENTS
%       DO ms=1,DEPENDENT_BASIS%NUMBER_OF_ELEMENT_PARAMETERS
%         mhs=mhs+1
%         nhs=0
%         IF(EQUATIONS_MATRIX%UPDATE_MATRIX) THEN
%           !Loop over element columns
%           DO nh=1,FIELD_VARIABLE%NUMBER_OF_COMPONENTS
%             DO ns=1,DEPENDENT_BASIS%NUMBER_OF_ELEMENT_PARAMETERS
%               nhs=nhs+1
%               DO ni=1,DEPENDENT_BASIS%NUMBER_OF_XI
%                 PGMSI(ni)=QUADRATURE_SCHEME%GAUSS_BASIS_FNS(ms,PARTIAL_DERIVATIVE_FIRST_DERIVATIVE_MAP(ni),ng)
%                 PGNSI(ni)=QUADRATURE_SCHEME%GAUSS_BASIS_FNS(ns,PARTIAL_DERIVATIVE_FIRST_DERIVATIVE_MAP(ni),ng)
%               ENDDO !ni
%               SUM=0.0_DP
%               DO mi=1,DEPENDENT_BASIS%NUMBER_OF_XI
%                 DO ni=1,DEPENDENT_BASIS%NUMBER_OF_XI
%                   SUM=SUM+PGMSI(mi)*PGNSI(ni)*EQUATIONS%INTERPOLATION% &
%                     & GEOMETRIC_INTERP_POINT_METRICS(FIELD_U_VARIABLE_TYPE)%PTR%GU(mi,ni)
%                 ENDDO !ni
%               ENDDO !mi
%               EQUATIONS_MATRIX%ELEMENT_MATRIX%MATRIX(mhs,nhs)=EQUATIONS_MATRIX%ELEMENT_MATRIX%MATRIX(mhs,nhs)+SUM*RWG
%             ENDDO !ns
%           ENDDO !nh
%         ENDIF
%       ENDDO !ms
%     ENDDO !mh
%   ENDDO !ng
% \end{lstlisting}
% }


% % * Still explain that we loop over the rows of the element matrix,
% %   and the loop is composed of a loop over number of components and element parameters.

% \begin{tabular}{|rp{0.9\textwidth}|}
%   \hline
%   Line & Explanation \\
%   & \\
%   2 & Loop over the number of Gauss points\\
%   3 & Weight factor = Jacobian of the mapping * quadrature weight\\
%   6 & Loop ({\bf rows}) over the number of variable components 
%       (For the scalar case of Laplace, this number is 1 (scalar potential),
%       whereas for a system like 3D incompressible Navier-Stokes, 
%       this number is 4 (3 velocity components and pressure))\\
%   7 & Loop ({\bf rows}) over the number of element parameters (= the number of interpolation functions 
%       associated with this element) \\
%   12 & Loop ({\bf columns}) over the number of variable components\\ 
%   13 & Loop ({\bf columns}) over the number of element parameters\\
%   15 & Loop over the element $\xi$-directions\\
%   20 & Loop over the element $\xi$-directions\\
%   21 & Loop over the element $\xi$-directions\\
%   26 & Add contribution to element matrix entry {\tt (mhs,nhs)}\\
%   \hline
% \end{tabular}


